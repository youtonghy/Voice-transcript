(function () {
  if (!window.appI18n || typeof window.appI18n.extend !== 'function') {
    console.warn('[i18n] base locale loader: appI18n not ready');
    return;
  }

  const translations = {
    en: {
      'common.backNav': '← Back',
      'common.backLink': 'Back',

      'index.title': 'Voice Transcript Studio',
      'index.tooltips.recordStart': 'Start Recording',
      'index.tooltips.recordStop': 'Stop Recording',
      'index.tooltips.voiceInput': 'Voice Input Settings',
      'index.tooltips.settings': 'Settings',
      'index.tooltips.media': 'Media File Transcription',
      'index.logTitle': 'Real-Time Logs',
      'index.buttons.exportLogs': 'Export Logs',
      'index.buttons.copyLatest': 'Copy Latest Result',
      'index.buttons.clearLogs': 'Clear Logs',
      'index.volume.current': 'Current Volume',
      'index.volume.waiting': 'Waiting For Recording',
      'index.volume.recording': 'Recording...',
      'index.volume.expand': 'Expand',
      'index.volume.collapse': 'Collapse',
      'index.volume.expandTooltip': 'Expand volume monitor',
      'index.volume.collapseTooltip': 'Collapse volume monitor',
      'index.volume.silenceRange': 'Silence Range',
      'index.volume.silenceRangeLabel': 'Silence Range ({value} dB)',
      'index.status.starting': 'Starting Python service...',
      'index.status.running': 'Service running',
      'index.status.error': 'Service error',
      'index.status.stopped': 'Service stopped',
      'index.recordButton.starting': 'Service starting...',
      'index.log.backendFailed': 'Backend connection failed',
      'index.log.openaiMissing': 'OpenAI not configured (required for selected source)',
      'index.log.sonioxMissing': 'Soniox not configured (current source: Soniox)',
      'index.log.geminiMissing': 'Gemini not configured (current translation engine: Gemini)',
      'index.log.configLoadFailed': 'Failed to load configuration',
      'index.log.notReadyStart': 'Python service not ready, cannot start recording',
      'index.log.notReadyRecord': 'Python service not ready, cannot record',
      'index.log.recordingError': 'Recording error',
      'index.statusText.recording': 'Recording...',
      'index.statusText.ready': 'Ready',
      'index.statusText.notReady': 'Service not ready',
      'index.result.transcribing': 'Transcribing...',
      'index.result.translating': 'Translating...',
      'index.translation.loading': 'Translating...',
      'index.serviceMessages.started': ['Transcription service started', 'Service started'],
      'index.serviceMessages.stopped': ['Transcription service stopped', 'Service stopped'],
      'index.serviceMessages.pythonError': ['Python process start failed', 'Python start failed', 'Python error'],
      'index.serviceMessages.moduleError': ['Module import failed'],

      'settings.nav.title': 'Settings',
      'settings.nav.backTooltip': 'Back to main window',
      'settings.header.title': 'Settings',
      'settings.header.subtitle': 'Configure API keys and transcription/translation options.',
      'settings.section.recognitionEngine': 'Recognition Engine',
      'settings.section.translationEngine': 'Translation Engine',
      'settings.section.openaiCommon': 'OpenAI Common Settings',
      'settings.section.translation': 'Translation Settings',
      'settings.section.transcription': 'Transcription Settings',
      'settings.section.recording': 'Recording Settings',
      'settings.section.interfaceLanguage': 'Interface Language',
      'settings.labels.recognitionEngine': 'Recognition Engine',
      'settings.labels.openaiTranscribeModel': 'Transcribe Model',
      'settings.labels.sonioxApiKey': 'Soniox API Key',
      'settings.labels.dashscopeApiKey': 'DashScope API Key',
      'settings.labels.qwen3AsrModel': 'Qwen3-ASR Model',
      'settings.labels.translationEngine': 'Translation Engine',
      'settings.labels.geminiApiKey': 'Gemini API Key',
      'settings.labels.geminiTranslateModel': 'Gemini Model',
      'settings.labels.openaiTranslateModel': 'Translate Model',
      'settings.labels.apiKey': 'OpenAI API Key',
      'settings.labels.apiUrl': 'API Base URL (optional)',
      'settings.labels.enableTranslation': 'Enable Auto Translation',
      'settings.labels.translationMode': 'Translation Mode',
      'settings.labels.targetLanguage': 'Target Language',
      'settings.labels.language1': 'Language 1',
      'settings.labels.language2': 'Language 2',
      'settings.labels.transcribeLanguage': 'Transcription Language',
      'settings.labels.silenceThreshold': 'Silence Threshold',
      'settings.labels.silenceDuration': 'Silence Split Duration (seconds)',
      'settings.labels.theaterMode': 'Theater Mode',
      'settings.labels.appLanguage': 'Choose Language',
      'settings.placeholders.customLanguage': 'Enter a custom language',
      'settings.notes.recognitionEngine': 'Choose the provider for speech recognition (transcription).',
      'settings.notes.openaiTranscribeModel': 'Audio transcription model (default gpt-4o-transcribe).',
      'settings.notes.sonioxApiKey': 'Required when the recognition engine is Soniox.',
      'settings.notes.dashscopeApiKey': 'Qwen3-ASR is provided via DashScope. Enter your DashScope API Key (or set environment variable DASHSCOPE_API_KEY).',
      'settings.notes.qwen3AsrModel': 'Default is qwen3-asr-flash; change if you need another model.',
      'settings.notes.translationEngine': 'Choose the provider for text translation (OpenAI or Gemini).',
      'settings.notes.geminiApiKey': 'Gemini Developer API key stored locally for translation.',
      'settings.notes.geminiTranslateModel': 'Default system prompt is generated automatically; override the model if needed.',
      'settings.notes.openaiTranslateModel': 'Model used for text translation.',
      'settings.notes.apiKey': 'Saved to local config.json; shared by transcription and translation.',
      'settings.notes.apiUrl': 'Leave empty to use OpenAI default; if custom, end with /v1.',
      'settings.notes.translationMode': 'Fixed: always translate to the target; Smart: better for bilingual conversations.',
      'settings.notes.targetLanguage': 'Select a common language or choose "Custom..." and type a language name.',
      'settings.notes.transcribeLanguage': 'Choosing "Auto Detect" will not use a prompt; choosing a specific language will use the prompt "Please transcribe in XX language".<br><strong>Note: In Smart translation mode, transcription language will be auto-detected.</strong>',
      'settings.notes.silenceThreshold': 'Smaller is more sensitive. Recommended range: 0.005–0.02.',
      'settings.notes.silenceDuration': 'Split when continuous silence exceeds this duration.',
      'settings.notes.theaterMode': 'Amplify quiet audio to normal speech volume to improve recognition.',
      'settings.notes.appLanguage': 'Changes take effect immediately and will be saved to your configuration.',
      'settings.notify.saved': 'Settings saved',
      'settings.notify.saveFailed': 'Save failed',
      'settings.notify.loadFailed': 'Failed to load configuration',
      'settings.notify.reloaded': 'Configuration reloaded',
      'settings.error.translationLanguageRequired': 'Please set the target translation language',

      'media.pageTitle': 'Media Transcription & Translation',
      'media.nav.title': 'Media Transcription',
      'media.nav.backTooltip': 'Back to main window',
      'media.panel.file': 'Select File',
      'media.panel.processing': 'Processing Settings',
      'media.panel.output': 'Output Settings',
      'media.labels.recognitionEngine': 'Transcription Engine',
      'media.labels.translationEngine': 'Translation Engine',
      'media.labels.outputPath': 'Save Location',
      'media.setting.enableTranslation': 'Enable Translation',
      'media.setting.targetLanguage': 'Target Language',
      'media.setting.theaterMode': 'Enable Theater Mode (audio enhancement)',
      'media.actions.choosePathPlaceholder': 'Choose a save location',
      'media.actions.browse': 'Browse',
      'media.actions.start': 'Start Processing',
      'media.actions.clear': 'Clear Selection',
      'media.actions.export': 'Export TXT',
      'media.upload.select': 'Click to choose a media file',
      'media.upload.supportVideo': 'Supported video: MP4, AVI, MOV, MKV, ...',
      'media.upload.supportAudio': 'Supported audio: WAV, MP3, FLAC, AAC, ...',
      'media.results.title': 'Results',
      'media.results.empty': 'Select a media file and start processing to view the transcription here.',
      'media.results.segmentLabel': 'Segment {index}',
      'media.file.selected': 'Selected',
      'media.progress.preparing': 'Preparing...',
      'media.progress.complete': 'Processing complete',
      'media.error.dragNotSupported': 'Please click to choose a file; drag-and-drop is not supported yet.',
      'media.error.selectFileFailed': 'Failed to select file',
      'media.error.selectOutputFailed': 'Failed to select output path',
      'media.error.missingFileOrOutput': 'Please select a file and output path.',
      'media.error.customLanguageRequired': 'Please enter a custom target language.',
      'media.error.processingFailed': 'Processing failed',
      'media.error.processingException': 'An error occurred while processing',
      'media.error.noResultsToExport': 'No results available to export.',
      'media.error.exportFailedStatus': 'Export failed',
      'media.error.exportFailed': 'Export failed',

      'voice.pageTitle': 'Voice Input Settings',
      'voice.nav.title': 'Voice Input Settings',
      'voice.nav.backTooltip': 'Back to main window',
      'voice.section.title': 'Voice Input',
      'voice.fields.enable': 'Enable voice input (press once to start, press again to stop)',
      'voice.fields.hotkey': 'Hotkey',
      'voice.fields.engine': 'Transcription Engine',
      'voice.fields.language': 'Transcription Language',
      'voice.fields.insertTranslation': 'Insert translation after completion',
      'voice.fields.insertNote': 'If enabled, the translation will be inserted after stopping.',
      'voice.fields.translateLanguage': 'Translation Target Language',
      'voice.placeholders.hotkey': 'e.g. F3 or A',
      'voice.notes.hotkey': 'Supports F1-F24, A-Z, 0-9',
      'voice.notify.loadFailed': 'Failed to load configuration',
      'voice.notify.saveFailed': 'Save failed'
    },

    zh: {
      'common.backNav': '← 返回',
      'common.backLink': '返回',

      'index.title': '语音转写工作台',
      'index.tooltips.recordStart': '开始录音',
      'index.tooltips.recordStop': '停止录音',
      'index.tooltips.voiceInput': '语音输入设置',
      'index.tooltips.settings': '设置',
      'index.tooltips.media': '媒体文件转写',
      'index.logTitle': '实时日志',
      'index.buttons.exportLogs': '导出日志',
      'index.buttons.copyLatest': '复制最新结果',
      'index.buttons.clearLogs': '清除日志',
      'index.volume.current': '当前音量',
      'index.volume.waiting': '等待录音',
      'index.volume.recording': '录音中',
      'index.volume.expand': '展开',
      'index.volume.collapse': '收起',
      'index.volume.expandTooltip': '展开音量监视',
      'index.volume.collapseTooltip': '收起音量监视',
      'index.volume.silenceRange': '静音范围',
      'index.volume.silenceRangeLabel': '静音范围（{value} dB）',
      'index.status.starting': '正在启动 Python 服务...',
      'index.status.running': '服务运行中',
      'index.status.error': '服务错误',
      'index.status.stopped': '服务已停止',
      'index.recordButton.starting': '服务启动中...',
      'index.log.backendFailed': '后端连接失败',
      'index.log.openaiMissing': '未配置 OpenAI（当前识别源需要）',
      'index.log.sonioxMissing': '未配置 Soniox（当前识别源为 Soniox）',
      'index.log.geminiMissing': '未配置 Gemini（当前翻译引擎为 Gemini）',
      'index.log.configLoadFailed': '读取配置失败',
      'index.log.notReadyStart': 'Python 服务未就绪，无法开始录音',
      'index.log.notReadyRecord': 'Python 服务未就绪，无法录音',
      'index.log.recordingError': '录音错误',
      'index.statusText.recording': '录音中...',
      'index.statusText.ready': '就绪',
      'index.statusText.notReady': '服务未就绪',
      'index.result.transcribing': '转写中...',
      'index.result.translating': '翻译中...',
      'index.translation.loading': '翻译中...',
      'index.serviceMessages.started': ['转写服务已启动', 'Python 转写服务启动', '服务已启动'],
      'index.serviceMessages.stopped': ['转写服务已停止', 'Python 转写服务停止', '服务已停止'],
      'index.serviceMessages.pythonError': ['Python 进程启动失败', 'Python 启动失败', 'Python 错误'],
      'index.serviceMessages.moduleError': ['模块导入失败', '无法导入模块'],

      'settings.nav.title': '设置',
      'settings.nav.backTooltip': '返回主窗口',
      'settings.header.title': '设置',
      'settings.header.subtitle': '配置 API 密钥以及转写和翻译选项。',
      'settings.section.recognitionEngine': '识别引擎',
      'settings.section.translationEngine': '翻译引擎',
      'settings.section.openaiCommon': 'OpenAI 通用设置',
      'settings.section.translation': '翻译设置',
      'settings.section.transcription': '转写设置',
      'settings.section.recording': '录音设置',
      'settings.section.interfaceLanguage': '界面语言',
      'settings.labels.recognitionEngine': '识别引擎',
      'settings.labels.openaiTranscribeModel': '转写模型',
      'settings.labels.sonioxApiKey': 'Soniox API Key',
      'settings.labels.dashscopeApiKey': 'DashScope API Key',
      'settings.labels.qwen3AsrModel': 'Qwen3-ASR 模型',
      'settings.labels.translationEngine': '翻译引擎',
      'settings.labels.geminiApiKey': 'Gemini API Key',
      'settings.labels.geminiTranslateModel': 'Gemini 模型',
      'settings.labels.openaiTranslateModel': '翻译模型',
      'settings.labels.apiKey': 'OpenAI API Key',
      'settings.labels.apiUrl': 'API 基础地址（可选）',
      'settings.labels.enableTranslation': '启用自动翻译',
      'settings.labels.translationMode': '翻译模式',
      'settings.labels.targetLanguage': '目标语言',
      'settings.labels.language1': '语言 1',
      'settings.labels.language2': '语言 2',
      'settings.labels.transcribeLanguage': '转写语言',
      'settings.labels.silenceThreshold': '静音阈值',
      'settings.labels.silenceDuration': '静音分段时长（秒）',
      'settings.labels.theaterMode': '剧场模式',
      'settings.labels.appLanguage': '选择语言',
      'settings.placeholders.customLanguage': '输入自定义语言',
      'settings.notes.recognitionEngine': '选择用于语音识别（转写）的服务提供商。',
      'settings.notes.openaiTranscribeModel': '音频转写模型（默认为 gpt-4o-transcribe）。',
      'settings.notes.sonioxApiKey': '当识别引擎为 Soniox 时需要填写。',
      'settings.notes.dashscopeApiKey': 'Qwen3-ASR 由 DashScope 提供，请填写 DashScope API Key（或配置环境变量 DASHSCOPE_API_KEY）。',
      'settings.notes.qwen3AsrModel': '默认使用 qwen3-asr-flash，可根据需要更换模型。',
      'settings.notes.translationEngine': '选择文本翻译的服务提供商（OpenAI 或 Gemini）。',
      'settings.notes.geminiApiKey': 'Gemini 开发者 API Key，本地保存用于翻译。',
      'settings.notes.geminiTranslateModel': '系统提示默认自动生成，必要时可自定义模型。',
      'settings.notes.openaiTranslateModel': '用于文本翻译的模型。',
      'settings.notes.apiKey': '保存在本地 config.json，供转写与翻译共用。',
      'settings.notes.apiUrl': '留空则使用 OpenAI 默认地址；如自定义需以 /v1 结尾。',
      'settings.notes.translationMode': '固定模式：始终翻译为目标语言；智能模式：更适合双语对话。',
      'settings.notes.targetLanguage': '选择常用语言，或选择“自定义...”并输入语言名称。',
      'settings.notes.transcribeLanguage': '选择“自动检测”将不使用提示；指定语言会使用“Please transcribe in XX language”。<br><strong>注意：在智能翻译模式下会自动检测转写语言。</strong>',
      'settings.notes.silenceThreshold': '数值越小越敏感。推荐范围：0.005–0.02。',
      'settings.notes.silenceDuration': '当连续静音超过该时长时进行分段。',
      'settings.notes.theaterMode': '放大较小的音量至正常语音，提升识别效果。',
      'settings.notes.appLanguage': '修改后立即生效，并会保存到配置文件。',
      'settings.notify.saved': '设置已保存',
      'settings.notify.saveFailed': '保存失败',
      'settings.notify.loadFailed': '加载配置失败',
      'settings.notify.reloaded': '配置已重新加载',
      'settings.error.translationLanguageRequired': '请设置目标翻译语言',

      'media.pageTitle': '媒体转写与翻译',
      'media.nav.title': '媒体转写',
      'media.nav.backTooltip': '返回主窗口',
      'media.panel.file': '选择文件',
      'media.panel.processing': '处理设置',
      'media.panel.output': '输出设置',
      'media.labels.recognitionEngine': '转写引擎',
      'media.labels.translationEngine': '翻译引擎',
      'media.labels.outputPath': '保存位置',
      'media.setting.enableTranslation': '启用翻译',
      'media.setting.targetLanguage': '目标语言',
      'media.setting.theaterMode': '启用剧场模式（音频增强）',
      'media.actions.choosePathPlaceholder': '选择保存位置',
      'media.actions.browse': '浏览',
      'media.actions.start': '开始处理',
      'media.actions.clear': '清除选择',
      'media.actions.export': '导出 TXT',
      'media.upload.select': '点击选择媒体文件',
      'media.upload.supportVideo': '支持视频：MP4、AVI、MOV、MKV 等',
      'media.upload.supportAudio': '支持音频：WAV、MP3、FLAC、AAC 等',
      'media.results.title': '处理结果',
      'media.results.empty': '选择媒体文件并开始处理后，内容会显示在此处。',
      'media.results.segmentLabel': '片段 {index}',
      'media.file.selected': '已选择',
      'media.progress.preparing': '准备中...',
      'media.progress.complete': '处理完成',
      'media.error.dragNotSupported': '请点击选择文件，目前暂不支持拖放。',
      'media.error.selectFileFailed': '选择文件失败',
      'media.error.selectOutputFailed': '选择输出路径失败',
      'media.error.missingFileOrOutput': '请先选择文件和输出路径。',
      'media.error.customLanguageRequired': '请输入自定义目标语言。',
      'media.error.processingFailed': '处理失败',
      'media.error.processingException': '处理过程中出现异常',
      'media.error.noResultsToExport': '没有可导出的结果。',
      'media.error.exportFailedStatus': '导出失败',
      'media.error.exportFailed': '导出失败',

      'voice.pageTitle': '语音输入设置',
      'voice.nav.title': '语音输入设置',
      'voice.nav.backTooltip': '返回主窗口',
      'voice.section.title': '语音输入',
      'voice.fields.enable': '启用语音输入（按一次开始，再按一次停止）',
      'voice.fields.hotkey': '快捷键',
      'voice.fields.engine': '转写引擎',
      'voice.fields.language': '转写语言',
      'voice.fields.insertTranslation': '完成后插入翻译结果',
      'voice.fields.insertNote': '启用后，在结束时会插入翻译文本。',
      'voice.fields.translateLanguage': '翻译目标语言',
      'voice.placeholders.hotkey': '例如 F3 或 A',
      'voice.notes.hotkey': '支持 F1-F24、A-Z、0-9',
      'voice.notify.loadFailed': '加载配置失败',
      'voice.notify.saveFailed': '保存失败'
    }
  };

  window.appI18n.extend(translations);
})();
